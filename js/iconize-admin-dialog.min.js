var iconizeAdminDialog;!function(i){"use strict";var e,o,n,a,l={},t=[],c=[],s=[],r=[],d=[],m=[],v=[],g=[],p=[],h=[],f=["iconized","iconized-stack","iconized-stack-base"],u="hover-color-change",z="",C="",D="",A="",w="",k="",P="",y="",b="",x="",T="",O="",S="",_="",I="",j="",V="",L="",Z="",F="",Q="",q="",B="";iconizeAdminDialog={init:function(){if(l.dialog=i("#iconize-admin-modal"),l.submit=i("#iconize-admin-update"),l.remove=i("#iconize-admin-remove"),l.set=i("#admin-icon-set"),l.name=i("#admin-icon-name"),l.effect=i("#admin-icon-effect"),l.transform=i("#admin-icon-transform"),l.animate=i("#admin-icon-animate"),l.hover=i("#admin-icon-hover"),l.color=i("#admin-icon-color"),l.hovercolor=i("#admin-icon-color-hover"),l.size=i("#admin-icon-size"),l.align=i("#admin-icon-align"),l.custom=i("#admin-icon-custom-classes"),o=i("#iconize-admin-icons"),n=i("#iconize-admin-title"),a=i("#admin-color-hover-checkbox"),r=iconizeAdminDialog.getSelectOptions(l.set),g=iconizeAdminDialog.getSelectOptions(l.transform),p=iconizeAdminDialog.getSelectOptions(l.animate),h=iconizeAdminDialog.getSelectOptions(l.hover),m=iconizeAdminDialog.getSelectOptions(l.size),v=iconizeAdminDialog.getSelectOptions(l.align),s=iconizeAdminDialog.getSelectOptions(l.effect),iconizeDialogParams.icons)for(var E=0;E<r.length;E++){var G=r[E],H=iconizeDialogParams.icons[G],J=i('<ul id="'+G+'-icons-list">').addClass("icons-list");o.append(J),i.merge(c,H);for(var K=0;K<H.length;K++){var M=H[K],N="glyph-"+M,R="";R='<li class="icons-list-item">',R+='<a href="#" class="icons-list-icon" title="'+M+'" data-set="'+G+'">',R+='<span class="iconized '+G+" "+N+'"></span>',R+="</a>",R+="</li>",J.append(R),t.push({label:M,set:G}),d.push(N)}}f.push(u),i.merge(f,d),i.merge(f,r),i.merge(f,g),i.merge(f,p),i.merge(f,h),i.merge(f,m),i.merge(f,v),l.color.wpColorPicker({change:function(){iconizeAdminDialog.setColor(i(this).wpColorPicker("color")),a.removeClass("hidden")},clear:function(){iconizeAdminDialog.setColor(""),a.addClass("hidden"),l.hovercolor.prop("checked",!1)}}),l.name.iconizeautocomplete({appendTo:l.dialog,source:t,minLength:1,change:function(e,n){if(null===n.item){var a=o.find(".selected-icon"),t=a.attr("title"),c=a.data("set");a.length?(i(this).val(t),l.set.val(c)):(i(this).val(""),l.set.val(r[0]))}},select:function(i,e){o.find(".icons-list-icon.selected-icon").removeClass("selected-icon"),l.set.val(e.item.set),o.find(".icons-list").hide(),o.find("#"+e.item.set+"-icons-list").show(),o.find("."+e.item.set+".glyph-"+e.item.value).parent().addClass("selected-icon"),l.name.val(e.item.value),iconizeAdminDialog.scrollToIcon()}}).bind("focus",(function(){i(this).iconizeautocomplete("search")})),i("#iconize-admin-modal .icons-list-icon").click((function(e){e.preventDefault();var n=i(this);!1===n.hasClass("selected-icon")&&(o.find(".icons-list-icon.selected-icon").removeClass("selected-icon"),n.addClass("selected-icon"),l.name.val(n.attr("title")))})),l.custom.tagit({autocomplete:{disabled:!0},preprocessTag:function(i){if(!i)return"";var e=i.replace(/^[^-_a-zA-Z]+/,"").replace(/^-(?:[-0-9]+)/,"-");return e&&e.replace(/[^-_a-zA-Z0-9]+/g,"-")},afterTagAdded:function(e,o){-1!==i.inArray(o.tagLabel,f)&&(alert(iconizeDialogParams.l10n.reserved_class),l.custom.tagit("removeTag",o.tag))}}),l.set.change((function(){var e="#"+i(this).val()+"-icons-list";o.find(".icons-list").hide(),o.find(e).show(),o.scrollTop(0)})),l.submit.click((function(i){i.preventDefault(),iconizeAdminDialog.update()})),l.remove.click((function(i){i.preventDefault(),iconizeAdminDialog.remove()})),i(document).on("click",".preview-icon",(function(o){o.preventDefault(),e=i(this),z=e.parent().next().children(".iconize-input-name").attr("id"),C=e.parent().next().children(".iconize-input-set").attr("id"),D=e.parent().next().children(".iconize-input-transform").attr("id"),A=e.parent().next().children(".iconize-input-color").attr("id"),w=e.parent().next().children(".iconize-input-size").attr("id"),k=e.parent().next().children(".iconize-input-align").attr("id"),P=e.parent().next().children(".iconize-input-custom-classes").attr("id"),b="#"+C,x="#"+D,T="#"+A,O="#"+w,S="#"+k,_="#"+P,I=i(y="#"+z).val(),j=i(b).val(),V=i(x).val(),L=i(T).val(),Z=i(O).val(),F=i(S).val(),Q=i(_).val(),q="."+j+"."+I,iconizeAdminDialog.show()})),iconizeAdminDialog.updatePreviewIconColors(),i(document).on("ajaxStop",(function(){iconizeAdminDialog.updatePreviewIconColors()})),i("form#addtag input#submit").click((function(e){var o=i(this).parents("form");validateForm(o)&&(B="clicked")})),i(document).on("ajaxComplete",(function(){i("body").hasClass("edit-tags-php")&&("clicked"===B&&iconizeAdminDialog.remove(),B="")})),l.dialog.on("shown.wpbs.modal",(function(){iconizeAdminDialog.scrollToIcon(!0)})),l.dialog.on("hidden.wpbs.modal",iconizeAdminDialog.closed)},show:function(){var e,t,c=[],m=!1;if(d.length){if(o.addClass("loading-overlay"),iconizeAdminDialog.clearColorPicker(),iconizeAdminDialog.clearCustomClasses(),""!==I&&""!==j)if(l.remove.show(),-1!==i.inArray(I,d)&&-1!==i.inArray(j,r))for(n.text(iconizeDialogParams.l10n.edit),l.submit.text(iconizeDialogParams.l10n.update),l.set.val(j),o.find(".icons-list").hide(),o.find("#"+j+"-icons-list").show(),o.find(".icons-list-icon.selected-icon").removeClass("selected-icon"),o.find(q).parent().addClass("selected-icon"),l.name.val(I.replace("glyph-","")),V?-1!==i.inArray(V,g)?(l.effect.val("transform"),l.transform.val(V)):-1!==i.inArray(V,p)?(l.effect.val("animate"),l.animate.val(V)):-1!==i.inArray(V,h)&&(l.effect.val("hover"),l.hover.val(V)):(l.effect.val(s[0]),l.transform.val(""),l.animate.val(""),l.hover.val("")),iconizeAdminDialog.showChildOptions(l.effect),l.color.val(L),l.color.wpColorPicker("color",L),l.size.val(Z),l.align.val(F),c=Q.split(","),L?(c.length&&-1!==(t=i.inArray(u,c))&&(m=!0,c.splice(t,1)),a.removeClass("hidden")):a.addClass("hidden"),l.hovercolor.prop("checked",m),e=0;e<c.length;e++)l.custom.tagit("createTag",c[e]);else alert(iconizeDialogParams.l10n.no_icon_found_admin),iconizeAdminDialog.setDefaultValues();else l.remove.hide(),iconizeAdminDialog.setDefaultValues();l.dialog.wpbsmodal("show")}else alert(iconizeDialogParams.l10n.no_icons_defined)},close:function(){l.dialog.wpbsmodal("hide");var o=e.parent().parent().parent().parent().find("input.widget-control-save");if(i("body").hasClass("wp-customizer")){o.length&&o.click();var n=e.parent().parent().find("button.customizer-preview-icon-trigger");n.length&&n.click()}i(y).trigger("change")},closed:function(){e.focus()},update:function(){var o="",n="",a="",t="",c="",s="",r="",d="",m="";l.name.val()?(o=l.set.val(),n="glyph-"+l.name.val(),"transform"===(a=l.effect.val())?t=l.transform.val():"animate"===a?t=l.animate.val():"hover"===a&&(t=l.hover.val()),c=l.color.val(),s=l.hovercolor.prop("checked"),r=l.size.val(),d=l.align.val(),m=(m=l.custom.tagit("assignedTags")).toString(),s&&(m?m+=",hover-color-change":m=u),i(y).val(n),i(b).val(o),i(x).val(t),i(T).val(c),i(O).val(r),i(S).val(d),i(_).val(m),e.children().removeClass().addClass("iconized").addClass(o).addClass(n).addClass(t).css("color",c),s&&e.children().addClass(u),iconizeAdminDialog.close()):alert(iconizeDialogParams.l10n.no_icon_selected)},remove:function(){l.set.val(""),l.name.val(""),l.effect.val(s[0]),l.transform.val(""),l.animate.val(""),l.hover.val(""),l.color.val(""),l.hovercolor.prop("checked",!1),l.size.val(""),l.align.val(""),iconizeAdminDialog.clearColorPicker(),iconizeAdminDialog.clearCustomClasses(),i(y).val(""),i(b).val(""),i(x).val(""),i(T).val(""),i(O).val(""),i(S).val(""),i(_).val(""),e.children().removeClass().css("color",""),iconizeAdminDialog.close()},setDefaultValues:function(){n.text(iconizeDialogParams.l10n.add),l.submit.text(iconizeDialogParams.l10n.add),l.set.val(r[0]),o.find(".icons-list").hide(),o.find("#"+r[0]+"-icons-list").show(),l.name.val(""),o.find(".icons-list-icon.selected-icon").removeClass("selected-icon"),l.effect.val(s[0]),l.transform.val(""),l.animate.val(""),l.hover.val(""),iconizeAdminDialog.showChildOptions(l.effect),l.color.val(""),l.hovercolor.prop("checked",!1),a.addClass("hidden"),l.size.val(""),l.align.val("")},updatePreviewIconColors:function(){i(".preview-icon").each((function(){var e,o=i(this),n="",a=[];e=o.parent().next().children(".iconize-input-color").val(),n=o.parent().next().children(".iconize-input-custom-classes").val(),""!==e&&(o.children().css("color",e),(a=n.split(",")).length&&-1!==i.inArray(u,a)&&o.children().addClass(u))}))},setColor:function(i){l.color.val(i)},clearColorPicker:function(){l.color.wpColorPicker("color",""),i("#iconize-admin-modal .wp-color-result").removeAttr("style")},clearCustomClasses:function(){l.custom.tagit("removeAll")},scrollToIcon:function(i){var e=i||!1,n="",a=0;(n=l.dialog.find(".selected-icon")).length&&(a=n.position().top-o.position().top+o.scrollTop()-92),!0===e?o.animate({scrollTop:a},"500","swing",(function(){o.removeClass("loading-overlay")})):o.scrollTop(a)},getSelectOptions:function(e){var o=[];return e.find("option").each((function(){var e=i(this).val();o.push(e)})),o},showChildOptions:function(e){var o=e,n=o.val(),a=".mother-opt-"+o.attr("id"),l=".mother-val-"+n;i(a).addClass("hidden"),i(a+l).removeClass("hidden")}},i(document).ready(iconizeAdminDialog.init)}(jQuery);